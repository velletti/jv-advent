{namespace nem=Allplan\NemConnections\ViewHelpers}
<f:if condition="{settings.day} > 5">
	<f:then>
		<f:if condition="{winnerdata}">

			<f:then>
				<div class="Tx_Nemadvent_pi1">
					<f:if condition="{settings.day} < 20">
						<f:then>
							<style type="text/css">
								img.desaturate {
									-webkit-filter: grayscale(1);
									-webkit-filter: grayscale(100%);
									filter: gray;
									filter: grayscale(100%);
									width: 140px;
									height:180px;
								}
							</style>
						</f:then>
						<f:else>
							<style type="text/css">
								img.desaturate {
									width: 140px;
									height:180px;
								}
							</style>
						</f:else>
					</f:if>
					<div>
						<div class="left">
							<button type="button"  class="btn btn-info btn-sm" data-target="#aventStatistik" data-toggle="modal"><i class="glyphicon glyphicon-info-sign"> </i></button> <i class="small "><span class="hidden-xs"><f:translate key="_votes_counted_until">Es wurden nur Antworten gewertet bis zum: </f:translate></span> {mindate}</i>
						</div>

						<div class="text-right">
							<button class="btn btn-primary btn-sm"  data-toggle="collapse" data-target=".allInfo">
								<i class="glyphicon glyphicon-resize-full" ></i>
							</button>
						</div>
					</div>
						<f:for each="{winnerdata}" as="winner" iteration="iteration">
							<f:cycle values="{0:'col-md-2 col-xs-5', 1:'col-md-2 col-xs-5 col-xs-offset-2 col-md-offset-0'}" as="colClass">
									<div class="{colClass} box-shadow">



									<f:if condition="{settings.showtotal} > 0">
										<f:then>
											<f:link.external uri="/user/{winner.username}"  defaultScheme="">
												<f:image title="{winner.username}" id="user{winner.feuser_uid}" alt="img" height="180c" width="140" src="{winner.tx_mmforum_avatar}"/>

											</f:link.external>

											<p title="Abgegebene Antworten : {winner.counttotal}">
												<f:format.crop maxCharacters="20" respectWordBoundaries="FALSE">{winner.username}</f:format.crop><br>
												P: {winner.pointtotal},{winner.subpointtotal} / {winner.counttotal}

												<br>
											</p>
										</f:then>
										<f:else>
											<f:if condition="{isnemintern} > 0">
												<f:then>
													<f:link.external uri="/user/{winner.username}"  defaultScheme="">
														<f:image title="{winner.username}" id="user{winner.feuser_uid}" alt="img" height="180c" width="140" src="{winner.tx_mmforum_avatar}"/>
													</f:link.external>
													<p title="gewertete Antworten : {winner.counttotal}">
														<f:format.crop maxCharacters="20" respectWordBoundaries="FALSE">{winner.username}</f:format.crop><br>
														P: {winner.pointtotal},{winner.subpointtotal} / {winner.counttotal}

														<br>
													</p>
												</f:then>
												<f:else>
													<f:if condition="{settings.day} > 24">
														<f:then>
															<f:image title="Unscharfe Vorschau auf die Gewinner Bilder " alt="img" height="18c" width="14" class="desaturate"  src="{winner.tx_mmforum_avatar}"/>
														</f:then>
														<f:else>

															<f:if condition="{settings.day} > 20">
																<f:then>
																	<f:image title="Unscharfe Vorschau auf die Gewinner Bilder " alt="img" height="9c" width="7" class="desaturate"  src="{winner.tx_mmforum_avatar}"/>
																</f:then>
																<f:else>

																	<f:if condition="{settings.day} > 18">
																		<f:then>
																			<f:image title="Unscharfe Vorschau auf die Gewinner Bilder " alt="img" height="6c" width="4" class="desaturate" src="{winner.tx_mmforum_avatar}"/>
																		</f:then>
																		<f:else>

																			<f:image title="Visible after the end of the game" alt="img"  height="18c" width="14" class="desaturate"  src="{winner.avatar}"/>
																		</f:else>
																	</f:if>


																</f:else>
															</f:if>
														</f:else>
													</f:if>

													<p title="Abgegebene Antworten : {winner.counttotal}" class="col-xs-12">Points: {winner.pointtotal},{winner.subpointtotal}

														<br>
													</p>
												</f:else>
											</f:if>
										</f:else>
									</f:if>
										<div style="position: absolute; bottom:5px; right: 35px;">
											<f:if condition="{winner.wishlistContent}">
												<f:if condition="{isnemintern} > 0">
													<div style="width:400px;  z-index: 9999" class="small collapse well well-sm well-default col-xs-12" id="wish-info-{winner.feuser_uid}">
														<f:format.html  parseFuncTSPath="">
															{winner.wishlistContent}
														</f:format.html>
													</div>
												</f:if>
											</f:if>

											<div class="small allInfo collapse well well-sm well-default col-xs-12" id="info-{winner.feuser_uid}">
												<div class="text-right"><span style="float:left;">Position: </span>{iteration.cycle}</div>
												<f:if condition="{settings.day} > 6">
													<div class="text-right"><span style="float:left;">Anz. Fragen: </span>{winner.counttotal}</div>
												</f:if>
												<f:if condition="{settings.day} > 8">
													<div class="text-right"><span style="float:left;">Land: </span> &nbsp;{winner.country}</div>
												</f:if>
												<f:if condition="{settings.day} > 10">
													<div class="text-right"><span style="float:left;">Registriert: </span>{winner.cryear}</div>
												</f:if>
												<f:if condition="{settings.day} > 12">
													<div class="text-right"><span style="float:left;">AKR Teilnahmen:</span>{winner.AKRcount}</div>
												</f:if>

												<f:if condition="{settings.day} > 16">
													<div class="text-right"><span style="float:left;"><f:format.date format="Y">now</f:format.date>:</span>
														<f:if condition="{isnemintern} > 0">
															<f:then>
																{winner.AKRfirst}<br>- {winner.AKRlast}
															</f:then>
															<f:else>
																<f:if condition="{settings.showtotal} > 0">
																	<f:then>
																		{winner.AKRfirst} <br>- {winner.AKRlast}
																	</f:then>
																	<f:else>
																		{winner.AKRfirstUser}-{winner.AKRlastUser}<f:format.date format="m.">now</f:format.date>
																	</f:else>
																</f:if>
															</f:else>
														</f:if>
													</div>
												</f:if>

												<f:if condition="{settings.day} > 14">
													<div class="text-right"><span style="float:left;">Postings {settings.Year}:</span>{winner.forumcount}</div>
												</f:if>



												<f:if condition="{settings.day} > 22">
													<div class="text-right"><span style="float:left;">Hilfreiche Posts:</span>{winner.tx_mmforum_helpful_count}</div>
													<div class="text-right"><span style="float:left;">Wunschzettel:</span>{f:if(condition: winner.wishlist , then: 'abgegeben', else: 'fehlt')}</div>
												</f:if>

												<f:if condition="{settings.day} > 16">
													<nem:renderIconByString usergroups="{winner.usergroup}" settings="{settings}"></nem:renderIconByString>
												</f:if>
											</div>

											<button class="btn btn-sm {winner.btnClass}"  data-toggle="collapse" data-target="#info-{winner.feuser_uid}">
												<i class="glyphicon glyphicon-info-sign" ></i>
											</button>

											<f:if condition="{isnemintern} > 0">
												<f:then>
													<span class="btn btn-sm right">
														<f:if condition="{winner.wishlist}">
															<f:then>
																<f:if condition="{winner.wishlistContent}">
																	<f:then>
																		<i class="glyphicon glyphicon-gift" data-toggle="collapse" data-target="#wish-info-{winner.feuser_uid}" title="Wunschliste abgegeben"></i>
																	</f:then>
																	<f:else>
																		<i class="glyphicon glyphicon-gift" title="Wunschliste abgegeben"></i>
																	</f:else>
																</f:if>

															</f:then>
															<f:else>
																<i class="glyphicon glyphicon-exclamation-sign" title="Keine Wunschliste abgegeben!"></i>
															</f:else>
														</f:if>
													</span>
												</f:then>
												<f:else>
													<f:if condition="{settings.day} > 20">
														<f:then>

																<span class="btn btn-sm right">
																	<f:if condition="{winner.counttotal} > 15">
																		<f:then>
																			<f:if condition="{winner.wishlist}">
																				<f:then>
																					<i class="glyphicon glyphicon-gift" title="Wunschliste abgegeben"></i>
																				</f:then>
																				<f:else>
																					<i class="glyphicon glyphicon-exclamation-sign" title="Keine Wunschliste abgegeben!"></i>
																				</f:else>
																			</f:if>
																		</f:then>
																	</f:if>
																</span>

														</f:then>
													</f:if>
												</f:else>
											</f:if>


										</div>

									<f:if condition="{isnemintern} > 0">
                                        <f:then>
                                            <f:if condition="{winner.isPowerUser}">
                                                <f:then>
                                                    <p> <br/></p>
                                                </f:then>
                                                <f:else>

                                                    <p><f:link.external title="Make him/her Poweruser" uri="/de/profil/firmennetzwerk.html?tx_nemconnections_pi1%5Bcontactno%5D={winner.tx_barafereguser_nem_navision_contactid}&tx_nemconnections_pi1%5Busergroup%5D=5&tx_nemconnections_pi1%5Baction%5D=addusertogroup&tx_nemconnections_pi1%5Bcontroller%5D=Connections" target="_blank" defaultScheme="">
                                                        {winner.tx_barafereguser_nem_navision_contactid}
                                                    </f:link.external><br /></p>

                                                </f:else>
                                            </f:if>
                                        </f:then>
                                        <f:else>
                                            <p> <br/></p>
                                        </f:else>
									</f:if>


								</div>
							</f:cycle>

						</f:for>
				</div>
				<div class="clearFix"><br> </div>
				<div class="right">
					<f:render partial="NextWinners" arguments="{offset: offset, newOffset: 0, newOffset1:1, newOffset2:72}" />
					<f:render partial="NextWinners" arguments="{offset: offset, newOffset: 72, newOffset1:73, newOffset2:144}" />
					<f:if condition="{isnemintern} > 0">
						<f:then>

							<f:render partial="NextWinners" arguments="{offset: offset, newOffset: 144, newOffset1:145, newOffset2:216}" />
							<f:render partial="NextWinners" arguments="{offset: offset, newOffset: 216, newOffset1:217, newOffset2: 288}" />
							<f:link.page class="btn btn-danger" additionalParams="{tx_nemadvent_pi1:{count:1000}}">Alle &gt;&gt;</f:link.page>
							<f:link.page class="btn btn-danger" additionalParams="{tx_nemadvent_pi1:{export:1,count:1000}}">CSV Export</f:link.page>
						</f:then>
					</f:if>
				</div>
				<div id="aventStatistik" class="modal fade" role="dialog">
					<div class="modal-dialog">

						<!-- Modal content-->
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal">&times;</button>
								<h4 class="modal-title">AKR Statistik</h4>
							</div>
							<div class="modal-body">
								<p>
									Diese angezeigten {settings.count} User haben in den letzten 12 Monaten gemeinsam <b>{settings.forumCount} Forumsbeiträge </b>geschrieben, davon wurden
									<b>{settings.helpfullCount} als hilfreich</b> bewertet.<f:if condition="{settings.userWith24Answers}">{settings.userWith24Answers} von Ihnen haben alle 24 Antworten abgegeben</f:if><br>
									<br>
									<br>
									<b>Teilnahmen an früheren Adventskalenderrätseln:</b>
									<f:if condition="{settings.akrCount}">
										<br>
										<f:for each="{settings.akrCount}" as="akr" iteration="akrIteration">
											{akrIteration.index} Teilnahmen: {akr} User<br>
										</f:for>
									</f:if>
									<br>
									Abgegebene Wunschzettel: {settings.wishlist}<br>
									<b>Neu-Registrierungen in Connect:</b><br>
									<br>{settings.newUser} User davon haben sich erst in {settings.Year} in Connect registriert<f:if condition="{settings.newUserDez}">, sowie {settings.newUserDez} erst mit Start des Adventskalenderrätsels</f:if>.
									<br>
                                    Dazu im Vergleich Teilnehmer insgesamt: {settings.totalUser} User.

								</p>
							</div>
						</div>
					</div>
				</div>



			</f:then>
			<f:else>
				<p><f:translate key="no_questions">Some definitions are missing in Plugin or actually no winner found</f:translate></p>


			</f:else>
		</f:if>
		</f:then>
		<f:else>
				<div class="alert alert-info">Die erste Rangliste ist erst ab dem 6.Dezember sichtbar!</div>
		</f:else>
</f:if>

